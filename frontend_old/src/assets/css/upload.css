/* ===== page must not scroll; only the table area should ===== */
html, body { height: 100%; }
body { overflow: hidden; }

/* ===== fixed messages so alerts donâ€™t push the card down ===== */
.messages-fixed{
  position: fixed;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 5000;
  width: min(960px, 92vw);
  display: flex;
  flex-direction: column;
  gap: .5rem;
}
.messages-fixed .alert{ margin: 0; }

/* ===== card fills (almost) the viewport and clips children ===== */
.page-card{
  height: calc(100dvh - 100px);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  margin-top: 50px;
  margin-bottom: 50px;
}
.page-card .card-body{
  display: flex;
  flex-direction: column;
  min-height: 0;
}

/* ===== table container owns leftover height inside card ===== */
.table-shell{
  flex: 1 1 auto;
  min-height: 0;
  display: flex;
  flex-direction: column;
}
.table-scroll{
  flex: 1 1 auto;
  min-height: 0;
  height: 100%;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  padding: 0 .25rem .5rem;
}

/* ===== sticky header inside the scroll container ===== */
#jobs-table thead th{
  position: sticky;
  top: 0;
  z-index: 5;
  background: var(--bs-body-bg, #fff);
  box-shadow: 0 2px 0 rgba(0,0,0,.03);
}

/* ===== stable table layout + truncation ===== */
#jobs-table{
  table-layout: fixed;
  width: 100%;
}
#jobs-table td, #jobs-table th{ vertical-align: middle; }
#jobs-table td:nth-child(1){
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ===== action buttons: wrap gracefully, never overflow ===== */
#jobs-table td.text-end.action{ overflow: visible; }
#jobs-table td.text-end.action > .d-flex,
#jobs-table td.text-end.action .action-row{
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-end;
  gap: .4rem;
  min-width: 0;
}
#jobs-table td.text-end.action .btn{ white-space: nowrap; }

/* ===== responsive column tweaks (optional) ===== */
@media (max-width: 992px){
  #jobs-table colgroup col:nth-child(1){ width: 40% !important; }
  #jobs-table colgroup col:nth-child(2){ width: 14% !important; }
  #jobs-table colgroup col:nth-child(3){ width: 16% !important; }
  #jobs-table colgroup col:nth-child(4){ width: 30% !important; }
}
@media (max-width: 576px){
  #jobs-table { table-layout: auto; }
}

/* ===== lightweight toasts (your originals) ===== */
.toast-area{
  position: fixed; top: 1rem; left: 50%; transform: translateX(-50%);
  z-index: 4000; display: flex; flex-direction: column; gap: .5rem;
  width: min(680px, 92vw);
}
.toast{
  border-radius: .5rem; padding: .75rem .9rem; box-shadow: 0 6px 18px rgba(0,0,0,.12);
  display: flex; align-items: center; justify-content: space-between; font-size: .95rem;
  border: 1px solid transparent;
}
.toast-danger{ background:#f8d7da; color:#842029; border-color:#f1aeb5; }
.toast-success{ background:#d1e7dd; color:#0f5132; border-color:#a3cfbb; }
.toast button{ all: unset; cursor: pointer; margin-left:.75rem; opacity:.7; }
.toast button:hover{ opacity:1; }

/* Modal body: keep vertical scroll, avoid horizontal jitter */
.modal .modal-body {
  overflow-x: hidden;
}

/* Make long code/path lines wrap in modal */
.modal .modal-body code,
.modal .modal-body .transcript {
  white-space: normal;
  word-break: break-word;
  overflow-wrap: anywhere;
}

/* Ensure the transcript gutter/chips look fine in the modal too */
.modal .transcript-wrap { position: relative; padding-left: 64px; }
.modal .gutter { position: absolute; left: 0; top: 0; width: 56px; pointer-events: none; }

/* keep the modal body as the scroll container */
.modal-dialog-scrollable .modal-body { overflow-y: auto; position: relative; }

/* Dark mode for transcript + legend + tooltip + gutter ticks */
:root[data-bs-theme="dark"] .transcript,
:root[data-bs-theme="dark"] .transcript .plain {
  color: #e5e7eb;
}

:root[data-bs-theme="dark"] .flagged:hover {
  box-shadow: inset 0 -0.25em rgba(255, 255, 255, 0.04);
}

/* keep category colors but make backgrounds darker-friendly */
:root[data-bs-theme="dark"] .lbl-bad   { background: rgba(255, 193, 7, 0.18);  border-bottom-color: #e1b300; }
:root[data-bs-theme="dark"] .lbl-hate  { background: rgba(220, 53, 69, 0.18);  border-bottom-color: #c33a45; }
:root[data-bs-theme="dark"] .lbl-abuse { background: rgba(111, 66, 193, 0.2);  border-bottom-color: #8460cf; }

:root[data-bs-theme="dark"] .chip.bad   { background: rgba(255,193,7,.12);  border-color:#e1b300; color:#f8f9fa; }
:root[data-bs-theme="dark"] .chip.hate  { background: rgba(220,53,69,.10); border-color:#c33a45; color:#f8f9fa; }
:root[data-bs-theme="dark"] .chip.abuse { background: rgba(111,66,193,.12); border-color:#8460cf; color:#f8f9fa; }

:root[data-bs-theme="dark"] .flag-fly {
  background: #1f2430;
  color: #e5e7eb;
  border-color: rgba(255,255,255,.08);
  box-shadow: 0 6px 18px rgba(0,0,0,.45);
}
:root[data-bs-theme="dark"] .flag-fly.bad   { border-color:#e1b300; }
:root[data-bs-theme="dark"] .flag-fly.hate  { border-color:#c33a45; }
:root[data-bs-theme="dark"] .flag-fly.abuse { border-color:#8460cf; }

:root[data-bs-theme="dark"] .gutter .tick {
  color: #9aa3af;
}
:root[data-bs-theme="dark"] .gutter .tick::after {
  background: rgba(255,255,255,.2);
}

#theme-toggle {
  line-height: 1;
  padding: 0.5rem 0.5rem;
  border-radius: 0.5rem;
  opacity: 0.8;
  transition: opacity .15s ease;
}
#theme-toggle:hover {
  opacity: 1;
}

/* center the Action column */
td.action-cell { text-align: center; }
.action-row {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
}


/* --- Column sizing via colgroup for stable layout --- */
#jobs-table {
  table-layout: fixed;
  width: 100%;
}
#jobs-table col.col-file   { width: 44%; }
#jobs-table col.col-size   { width: 12%; }
#jobs-table col.col-status { width: 12%; }
#jobs-table col.col-action { width: 32%; }

/* Center all headers cleanly */
#jobs-table thead th {
  text-align: center;
  position: sticky;
  top: 0;
  z-index: 5;
  background: var(--bs-body-bg, #fff);
  box-shadow: 0 2px 0 rgba(0,0,0,.03);
  white-space: nowrap;
}

/* Cells alignment + truncation */
#jobs-table td,
#jobs-table th { vertical-align: middle; }

#jobs-table td.file-cell {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

#jobs-table td.size-cell {
  font-variant-numeric: tabular-nums;
}

/* Status stays compact and centered */
#jobs-table td.status-cell .badge {
  font-weight: 600;
}

/* Action buttons: wrap nicely and stay centered */
.action-cell .action-row {
  display: inline-flex;
  flex-wrap: wrap;
  gap: .5rem;
  align-items: center;
  justify-content: center;
  min-width: 0;
}

/* Prevent buttons from stretching or breaking lines awkwardly */
.action-cell .btn {
  white-space: nowrap;
}

/* Responsive tweaks */
@media (max-width: 992px){
  #jobs-table col.col-file   { width: 46%; }
  #jobs-table col.col-size   { width: 14%; }
  #jobs-table col.col-status { width: 14%; }
  #jobs-table col.col-action { width: 26%; }
}
@media (max-width: 576px){
  /* Let table breathe on phones */
  #jobs-table { table-layout: auto; }
  #jobs-table thead th { font-size: .9rem; }
  .action-cell .btn { padding-inline: .5rem; }
}
